\mode<presentation>

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%                           Fonts                             %
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\setbeamerfont{title}{size=\Large, series=\fontseries{k}}
\setbeamerfont{sectionpage}{series=\fontseries{k}}
\setbeamerfont{subtitle}{parent={normal text}, size=\small, series=\mdseries}
\setbeamerfont{author}{size=\small, series=\mdseries}
\setbeamerfont{date}{size=\small, series=\mdseries}
\setbeamerfont{frametitle}{size=\large, series=\bfseries}
\setbeamerfont{framesubtitle}{parent={normal text}, series=\mdseries}
\setbeamerfont{title in head/foot}{parent={footline}}
\setbeamerfont{author in head/foot}{parent={footline}}
\setbeamerfont{section in toc}{series=\bfseries}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%                        Frame Background                     %
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%


\defbeamertemplate*{background canvas}{rptudefault}
{%
	\ifbeamercolorempty[bg]{background canvas}{}{\color{bg}\vrule width\paperwidth height\paperheight}% copied beamer default here
}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%                        Frame Title                          %
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%


\defbeamertemplate*{frametitle}{rptudefault}[1][]{
	\ifRPTU@displayNavigation%
		\vskip1ex%
	\fi
	\vspace*{\baselineskip}%
	\begin{beamercolorbox}[wd=\paperwidth,leftskip=0.25cm]{frametitle}
  		\usebeamerfont{frametitle}\insertframetitle
  		% check if subtitle exists
		\ifx\insertframesubtitle\@empty%
		\else%
			\vskip0pt%
			\usebeamerfont{framesubtitle}\insertframesubtitle
		\fi%
		\vskip0pt%
		\usebeamercolor[fg]{slide separation line}\rule[1ex]{1cm}{0.5pt} % add light separation line
	\end{beamercolorbox}
}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%                        Footline                             %
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\newcommand{\logoshort}[1]{
	\newcommand{\insertlogoshort}{#1}
}

% Logo for footer
\logoshort{%
\resizebox{!}{1.75ex}{\begin{tikzpicture}[font={\usebeamercolor[fg]{logo short}}, 
		%tight background,background rectangle/.style= {fill=red}, show background rectangle,    % used for testing the margins
		rotate=180, xscale=-1] %need rotate and xscale to shift the origin, given svg data has origin at top left
		\fill svg {% this is the R
			M 21,218 h 60.8 c 11.5,0,20.9,3.7,28.4,11.1c7.4,7.4,11.1,16.5,11.1,27.4c0,4.7-0.7,9.1-2,13.2
			c-1.4,4.1-3,7.4-5.1,9.8c-2,2.4-4.1,4.7-6.1,6.4c-2,1.7-3.7,3-5.1,3.7l-2,1l24.7,44.2H99.3L77,294H46v40.9H21L21,218L21,218z
			M92.2,245c-3-3-6.8-4.4-11.1-4.4H46v30.7h35.1c4.4,0,8.1-1.4,11.1-4.4c3-3,4.4-6.4,4.4-10.8C96.6,251.8,95.3,248,92.2,245
		}; 
		\fill svg {% this is the P
			M202.3,218c11.8,0,21.6,3.7,29.4,11.1c7.8,7.4,11.8,16.9,11.8,28c0,11.1-4.1,20.3-11.8,28
			c-7.8,7.4-17.6,11.1-29.4,11.1h-38.5v38.5h-24.7V218.3L202.3,218z M163.8,240.6V274h37.5c5.1,0,9.1-1.7,12.5-4.7
			c3.4-3,5.1-7.1,5.1-11.8c0-4.7-1.7-8.8-5.1-11.8c-3.4-3.4-7.4-4.7-12.5-4.7h-37.5V240.6z
		};
		\fill svg {% this is the T
			M352.3 218L352.3 240.6L312.4 240.6L312.4 334.8L287.8 334.8L287.8 240.6L247.9 240.6L247.9 218z
		};
		\fill svg{% this is the left part of the U
			M470.1,286.8V218h-24.6v68.7c0,7.7-2.3,14.2-7.4,19.6c-2.3,2.3-5.1,4.4-7.7,5.7c-0.6,0.3-0.7,0.3-1.4,0.7
			c-3.7,2-6.4,5.7-6.4,10.5c0,6.4,5.1,11.4,11.4,11.4c1,0,2.9-0.4,4.4-1c6.4-2.3,12.5-6.1,17.5-11.1
			C465.4,312.7,470.1,300.9,470.1,286.8
		};
		\fill svg{% this is the right part of the U
			M365.9,286.8c0,14.1,4.7,25.9,14.2,35.7c5.1,5.1,11.1,8.8,17.5,11.1c1.5,0.6,3.3,1,4.4,1
			c6.4,0,11.4-5,11.4-11.4c0-4.7-2.7-8.4-6.4-10.5c-0.6-0.3-0.8-0.4-1.4-0.7c-2.7-1.4-5.4-3.4-7.7-5.7c-5.1-5.4-7.4-11.8-7.4-19.6
			V218h-24.6L365.9,286.8
		};
	\end{tikzpicture}%
}}


% compute length
\newlength{\footmidpart}
\setlength{\footmidpart}{\dimexpr(\paperwidth-2.25cm)\relax}

% Footline
\defbeamertemplate*{footline}{rptudefault}{%
\ifnum \thepage=1%
	\begin{beamercolorbox}[wd=1\paperwidth, ht=3ex, dp=2ex, right]{footline}%
		% empty footline, need the same dimensions because otherwise beamer 
		% is not able to compute the correct dimensions of the footline
		% (Only computed once for the first slide, then no recomputation)
	\end{beamercolorbox}
	\else%
	\leavevmode\hbox{%
\begin{beamercolorbox}[wd=1cm, ht=3ex, dp=2ex, center]{footline} %
	\ifRPTU@displayTotalFrameNumber%
		\insertframenumber/\inserttotalframenumber%
	\else%
	\insertframenumber%
	\fi%
\end{beamercolorbox}%
\begin{beamercolorbox}[wd=\footmidpart, ht=3ex, dp=2ex]{footline} 
		% for an additional separation line
 		%{\usebeamercolor[fg]{slide separation line}\rule[-1pt]{0.5pt}{6pt}}
 		%\hspace*{0.5em}%
  		\usebeamerfont{footline}\insertshortauthor
  		\hspace*{0.5em}%
  		{\usebeamercolor[fg]{slide separation line}\rule[-1pt]{0.5pt}{6pt}}
  		\ifRPTU@displayInstitute%
  			\hspace*{0.5em}%
  			\usebeamerfont{footline}\insertshortinstitute
  			\hspace*{0.5em}%
  			{\usebeamercolor[fg]{slide separation line}\rule[-1pt]{0.5pt}{6pt}}
  		\fi%
  		\hspace*{0.5em}%
  		\usebeamerfont{title in head/foot}\let\hyperlink\@secondoftwo\insertshorttitle%  %no link for title in footline
\end{beamercolorbox}%
\begin{beamercolorbox}[wd=1.25cm, ht=3ex, dp=2ex, center]{footline} 
 		\insertlogoshort%
\end{beamercolorbox}
 }
\fi%
}

% beamer user guide page 122 -> for one line box always same size -> ht=2.25ex, dp=1ex
\newlength{\footlineheight}
\setlength{\footlineheight}{2.25ex}

\newlength{\footlinedp}
\setlength{\footlinedp}{1ex}

\defbeamertemplate*{footline}{rptuminimal}{%
\ifnum \thepage=1%
	\begin{beamercolorbox}[wd=1\paperwidth, ht=\footlineheight, dp=\footlinedp, right]{footline}%
		% empty footline, need the same dimensions because otherwise beamer 
		% is not able to compute the correct dimensions of the footline
		% (Only computed once for the first slide, then no recomputation)
	\end{beamercolorbox}
	\else%
	\leavevmode\hbox{%
\begin{beamercolorbox}[wd=1cm, ht=\footlineheight, dp=\footlinedp, center]{footline} %
\ifRPTU@displayTotalFrameNumber%
	\insertframenumber/\inserttotalframenumber%
\else%
	\insertframenumber%
\fi%
\end{beamercolorbox}%
\begin{beamercolorbox}[wd=\footmidpart, ht=\footlineheight, dp=\footlinedp]{footline} 
 		% empty mid part
\end{beamercolorbox}%
\begin{beamercolorbox}[wd=1.25cm, ht=\footlineheight, dp=\footlinedp, center]{footline} 
 		\insertlogoshort%
\end{beamercolorbox}
 }
\fi%
}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%                         Headline                            %
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\newlength{\headlineheight}
\setlength{\headlineheight}{0.06\paperheight}
\defbeamertemplate{headline}{rptudefault}{%
\ifnum\c@framenumber>1%
	\ifRPTU@displayNavigation%
		\begin{beamercolorbox}[wd=\paperwidth, ht=\headlineheight]{section in head/foot}
			\insertnavigation{\paperwidth}\vskip0pt%
		\end{beamercolorbox}
	\fi%
\fi%
}

\defbeamertemplate*{headline}{rptuminimal}{%
}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%                        Footnotes                            %
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\setbeamertemplate{footnote}{%
% change left margin compared to default
   \makebox[0.5em][l]{\scriptsize\insertfootnotemark}\scriptsize\insertfootnotetext\par%
}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%                     SWITCH BETWEEN STYLES                   %
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

% we need this reset otherwise the other options below become 
% global changes, here we reset everything to the default
\BeforeBeginEnvironment{frame}{%
	\setbeamertemplate{footline}[rptudefault]
	\setbeamertemplate{headline}[rptudefault]
	\setbeamertemplate{background canvas}[rptudefault]
	\setbeamercolor{titlelike}{fg=rptu2, bg=rptuweiss}
	\setbeamercolor{slide separation line}{fg = rptu2}
	\setbeamercolor{logo short}{fg=rptuschwarz}
	\setbeamercolor{normal text}{fg=rptuschwarz}
	\usebeamercolor[fg]{normal text}
	\setbeamercolor{item}{fg = rptu1}
	\setbeamercolor{navigation in head}{bg = rptuweiss}
	\setbeamercolor{section in toc}{fg=rptuschwarz}
	\setbeamercolor{subsection in toc}{fg=rptuschwarz}
	\setbeamercolor{section in head/foot}{fg=rptu1!80, bg=rptuweiss}
	\setbeamercolor{mini frame}{fg=rptu1!80, bg=rptuweiss}
	\setbeamercolor{caption}{fg = rptu1}
	\setbeamercolor{caption name}{fg = rptu1}
	
}

\define@key{beamerframe}{minimal}[true]{
	\setbeamertemplate{footline}[rptuminimal]
	\setbeamertemplate{headline}[rptuminimal]
}

% for each color define a slide with this color as background
% first color scheme of presentation
% RPTU1 as background
\define@key{beamerframe}{highlight1}[true]{%
	\setbeamertemplate{background canvas}
	{%
		\color{rptu1}\vrule width\paperwidth height\paperheight% added bg color
	}
	%	\setbeamertemplate{background canvas}[rptudark]%
	\setbeamercolor{titlelike}{fg=rptuweiss, bg=rptu1}
	\setbeamercolor{slide separation line}{fg = rptu2}
	\setbeamercolor{logo short}{fg=rptuweiss}
	\setbeamercolor{normal text}{fg=rptuweiss}
	\usebeamercolor[fg]{normal text}
	\setbeamercolor{item}{fg = rptu2}
	\setbeamercolor{navigation in head}{bg = rptu1}
	\setbeamercolor{section in toc}{fg=rptuweiss}
	\setbeamercolor{subsection in toc}{fg=rptuweiss}
	\setbeamercolor{section in head/foot}{fg=rptuweiss, bg=rptu1}
	\setbeamercolor{mini frame}{fg=rptuweiss, bg=rptu1}
	\setbeamercolor{caption}{fg = rptuweiss}
	\setbeamercolor{caption name}{fg = rptuweiss}
}

% RPTU2 as background
\define@key{beamerframe}{highlight2}[true]{%
	\setbeamertemplate{background canvas}
	{%
		\color{rptu2}\vrule width\paperwidth height\paperheight% added bg color
	}
	%	\setbeamertemplate{background canvas}[rptudark]%
	\setbeamercolor{titlelike}{fg=rptuweiss, bg=rptu2}
	\setbeamercolor{slide separation line}{fg = rptu1}
	\setbeamercolor{logo short}{fg=rptuweiss}
	\setbeamercolor{normal text}{fg=rptuweiss}
	\usebeamercolor[fg]{normal text}
	\setbeamercolor{item}{fg = rptu1}
	\setbeamercolor{navigation in head}{bg = rptu2}
	\setbeamercolor{section in toc}{fg=rptuweiss}
	\setbeamercolor{subsection in toc}{fg=rptuweiss}
	\setbeamercolor{item in toc}{fg=rptuweiss}
	\setbeamercolor{section in head/foot}{fg=rptuweiss, bg=rptu2}
	\setbeamercolor{mini frame}{fg=rptuweiss, bg=rptu2}
	\setbeamercolor{caption}{fg = rptuweiss}
	\setbeamercolor{caption name}{fg = rptuweiss}
}


\define@key{beamerframe}{black}[true]{%
	\setbeamertemplate{background canvas}
	{%
		\color{rptuschwarz}\vrule width\paperwidth height\paperheight% added bg color
	}
	%	\setbeamertemplate{background canvas}[rptudark]%
	\setbeamercolor{titlelike}{fg=rptuweiss, bg=rptuschwarz}
	\setbeamercolor{slide separation line}{fg = rptuweiss}
	\setbeamercolor{logo short}{fg=rptuweiss}
	\setbeamercolor{normal text}{fg=rptuweiss}
	\usebeamercolor[fg]{normal text}
	\setbeamercolor{item}{fg = rptuweiss}
	\setbeamercolor{navigation in head}{bg = rptuschwarz}
	\setbeamercolor{section in head/foot}{fg=rptuweiss, bg=rptuschwarz}
	\setbeamercolor{mini frame}{fg=rptuweiss, bg=rptu1}
	\setbeamercolor{caption}{fg = rptuweiss}
	\setbeamercolor{caption name}{fg = rptuweiss}
}

% if you want to can define analougsly slide keys for all other color schemes 
% to create really colorful presentations

\mode<all>


